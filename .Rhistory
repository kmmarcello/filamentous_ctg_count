theme(legend.position = "right",
text = element_text(size=10),
axis.text.x = element_text(angle = 60, hjust=1))+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
ggsave("figures/fil_gene_count_heatmap.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.3, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.90, y = 0.5, width = 0.01, height = 0.8))
temperature_gene <- filament_cyanos %>%
select(organism, tempurature_avg, contains("gene_")) %>%
filter(!is.na(tempurature_avg))
temperature_gene
temp_organism <- filament_cyanos %>%
select(organism, tempurature_avg, genus) %>%
filter(!is.na(tempurature_avg)) %>%
ggplot(aes(x = organism, y = tempurature_avg, fill = genus)) +
geom_col()+
scale_fill_viridis(discrete=TRUE, option = "mako")+
theme(legend.position = "right",
text = element_text(size=10),
axis.text.x = element_text(angle = 60, hjust=1))+
labs(title = "Environmental Temperature for Cyanobacteria Species",x = "Cyanobacteria", y = "Temperature C")
temp_organism
ggsave("figures/temp_organism_plot.png", width=10, height=6, plot = temp_organism, dpi = 200)
temp_organism <- filament_cyanos %>%
select(organism, tempurature_avg, genus, gene_des_a) %>%
filter(!is.na(tempurature_avg)) %>%
filter(!is.na(gene_des_a)) %>%
ggplot(aes(x = organism, y = gene_des_a, fill = genus)) +
geom_col()+
scale_fill_viridis(discrete=TRUE, option = "mako")+
theme(legend.position = "right",
text = element_text(size=10),
axis.text.x = element_text(angle = 60, hjust=1))+
labs(title = "CTG count for Cyanobacteria Species",x = "Cyanobacteria", y = "DesA Gene Count")
ggsave("figures/fil_gene_plot.png", width=10, height=6, plot = temp_organism, dpi = 200)
temp_organism
library("tidyverse")
library("janitor")
filament_cyanos <- read_csv("data/filamentous_cyano_meta.csv") %>% clean_names()
trim_fil_cyn <- filament_cyanos %>%
filter(!is.na(tempurature_avg)) %>%
select(genus, organism, starts_with("gene_")) %>%
mutate(organism = as.factor(organism), genus = as.factor(genus))
head(trim_fil_cyn)
trim_fil_cyn_long <- trim_fil_cyn %>%
pivot_longer(-c(genus, organism),
names_to ="gene",
values_to = "n")
trim_fil_cyn_long
trim_fil_cyn_long2<- trim_fil_cyn_long %>%
filter(n!=is.na(n))
trim_fil_cyn_long2
library(shiny)
library(shinydashboard)
library(shiny)
#ui <- dashboardPage(
dashboardHeader( title = "CTG count for Cyanobacteria Species"),
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.3, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.90, y = 0.5, width = 0.01, height = 0.8))
ggsave("figures/fil_heat_dendro.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heat_dendro <- fil_heatmap %>%
grid.newpage()
fil_heat_dendro <- fil_heatmap %>%
grid.newpage()
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.3, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.90, y = 0.5, width = 0.01, height = 0.8))
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "right",
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1))+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
ggsave("figures/fil_gene_count_heatmap.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.3, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.90, y = 0.5, width = 0.01, height = 0.8))
dendro_plot <- dendro_plot + theme(axis.text.y = element_text(size = 1))
dendro_plot
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.3, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.90, y = 0.5, width = 0.01, height = 0.8))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.3, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.80, y = 0.5, width = 0.01, height = 0.8))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.3, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.60, y = 0.5, width = 0.01, height = 0.8))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.3, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.60, y = 0.5, width = 0.2, height = 0.8))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.3, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.60, y = 0.5, width = 0.2, height = 1))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.8, y = 0.5, width = 0.2, height = 1))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.7, y = 0.5, width = 0.2, height = 1))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.7, y = 0.5, width = 0.2, height = 0.95))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.7, y = 0.5, width = 0.2, height = 0.98))
dendro_plot <- dendro_plot + theme(axis.text.y = element_text(size = 0))
dendro_plot
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.7, y = 0.5, width = 0.2, height = 0.98))
dendro_plot <- ggdendrogram(data = organisms_dendro, rotate = TRUE)
dendro_plot
dendro_plot <- ggdendrogram(data = organisms_dendro, rotate = TRUE)
dendro_plot
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Chunk 2
#install.packages("viridisLite")
#install.packages("svglite")
#install.packages("factoextra")
#install.packages("cluster")
#install.packages("ggdendro")
#install.packages("grid")
# Chunk 3
library(tidyverse)
library(RColorBrewer)
library(paletteer)
library(janitor)
library(here)
library(skimr)
library(viridis)
library(shiny)
library(shinydashboard)
library(devtools)
library(svglite)
library(cluster)
library(factoextra)
library(ggdendro)
library(grid)
# Chunk 4
filament_cyanos <- readr::read_csv("data/filamentous_cyano_meta.csv")
# Chunk 5
summary(filament_cyanos)
# Chunk 6
head(filament_cyanos)
# Chunk 7
filament_cyanos <- clean_names(filament_cyanos)
# Chunk 8
names(filament_cyanos)
# Chunk 9
head(filament_cyanos)
# Chunk 10
gene_data_genus <- filament_cyanos %>%
select(genus, contains("gene_")) %>%
pivot_longer(-genus,
names_to = "gene",
values_to = "gene_count") %>%
filter(!is.na(gene_count))
gene_data_genus
# Chunk 11
gene_data_genus$gene_count <- as.factor(gene_data_genus$gene_count)
# Chunk 12
fil_heatmap <- gene_data_genus %>%
ggplot(aes(y=gene, x=genus))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "right",
text = element_text(size=6),
axis.text.x = element_text(angle = 45, hjust=1))+
coord_fixed()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Genera",x = "Genus", y = "Gene")
ggsave("figures/fil_gene_count_genus_heatmap.svg", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap
# Chunk 13
gene_data_organism <- filament_cyanos %>%
select(organism, contains("gene_")) %>% # get rid of the gene_ part for the final pres.
pivot_longer(-organism,
names_to = "gene",
values_to = "gene_count") %>%
filter(!is.na(gene_count))
gene_data_organism
# Chunk 14
gene_data_organism$gene_count <- as.numeric(gene_data_organism$gene_count) # needs to be numeric for scale()
lapply(gene_data_organism, class)
# Chunk 15
clust_map_org <- gene_data_organism %>% # make pivot_wider for scale()
pivot_wider(names_from = "gene",
values_from = "gene_count")
clust_map_org
# Chunk 16
#clust_map_org <- scale(clust_map_org)
#clust_map_org %>%
#mutate(across(where(is.numeric, scale))
# this is where I got the info
# https://jcoliver.github.io/learn-r/008-ggplot-dendrograms-and-heatmaps.html
scaled_clust_map <- clust_map_org
scaled_clust_map[, c(2:22)] <- scale(scaled_clust_map[, 2:22])
scaled_clust_map
# Chunk 17
scaled_matrix <- as.matrix(scaled_clust_map[, c(2:22)])
rownames(scaled_matrix) <- scaled_clust_map$organism
organisms_dendro <- as.dendrogram(hclust(d = dist(x = scaled_matrix)))
# Chunk 18
dendro_plot <- ggdendrogram(data = organisms_dendro, rotate = TRUE)
dendro_plot
# Chunk 19
dendro_plot <- dendro_plot + theme(axis.text.y = element_text(size = 0))
dendro_plot
# Chunk 20
gene_data_organism$gene_count <- as.factor(gene_data_organism$gene_count)
lapply(gene_data_organism, class)
# Chunk 21
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "right",
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1))+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
ggsave("figures/fil_gene_count_heatmap.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap
# Chunk 22
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.7, y = 0.5, width = 0.2, height = 0.98))
# Chunk 23
temperature_gene <- filament_cyanos %>%
select(organism, tempurature_avg, contains("gene_")) %>%
filter(!is.na(tempurature_avg))
temperature_gene
# Chunk 24
temp_organism <- filament_cyanos %>%
select(organism, tempurature_avg, genus) %>%
filter(!is.na(tempurature_avg)) %>%
ggplot(aes(x = organism, y = tempurature_avg, fill = genus)) +
geom_col()+
scale_fill_viridis(discrete=TRUE, option = "mako")+
theme(legend.position = "right",
text = element_text(size=10),
axis.text.x = element_text(angle = 60, hjust=1))+
labs(title = "Environmental Temperature for Cyanobacteria Species",x = "Cyanobacteria", y = "Temperature C")
temp_organism
ggsave("figures/temp_organism_plot.png", width=10, height=6, plot = temp_organism, dpi = 200)
# Chunk 25
temp_organism <- filament_cyanos %>%
select(organism, tempurature_avg, genus, gene_des_a) %>%
filter(!is.na(tempurature_avg)) %>%
filter(!is.na(gene_des_a)) %>%
ggplot(aes(x = organism, y = gene_des_a, fill = genus)) +
geom_col()+
scale_fill_viridis(discrete=TRUE, option = "mako")+
theme(legend.position = "right",
text = element_text(size=10),
axis.text.x = element_text(angle = 60, hjust=1))+
labs(title = "CTG count for Cyanobacteria Species",x = "Cyanobacteria", y = "DesA Gene Count")
ggsave("figures/fil_gene_plot.png", width=10, height=6, plot = temp_organism, dpi = 200)
temp_organism
# Chunk 26
library("tidyverse")
library("janitor")
# Chunk 27
filament_cyanos <- read_csv("data/filamentous_cyano_meta.csv") %>% clean_names()
trim_fil_cyn <- filament_cyanos %>%
filter(!is.na(tempurature_avg)) %>%
select(genus, organism, starts_with("gene_")) %>%
mutate(organism = as.factor(organism), genus = as.factor(genus))
head(trim_fil_cyn)
# Chunk 28
trim_fil_cyn_long <- trim_fil_cyn %>%
pivot_longer(-c(genus, organism),
names_to ="gene",
values_to = "n")
trim_fil_cyn_long
# Chunk 29
trim_fil_cyn_long2<- trim_fil_cyn_long %>%
filter(n!=is.na(n))
trim_fil_cyn_long2
# Chunk 30
library(shiny)
library(shinydashboard)
library(shiny)
#ui <- dashboardPage(
dashboardHeader( title = "CTG count for Cyanobacteria Species"),
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Chunk 2
#install.packages("viridisLite")
#install.packages("svglite")
#install.packages("factoextra")
#install.packages("cluster")
#install.packages("ggdendro")
#install.packages("grid")
# Chunk 3
library(tidyverse)
library(RColorBrewer)
library(paletteer)
library(janitor)
library(here)
library(skimr)
library(viridis)
library(shiny)
library(shinydashboard)
library(devtools)
library(svglite)
library(cluster)
library(factoextra)
library(ggdendro)
library(grid)
# Chunk 4
filament_cyanos <- readr::read_csv("data/filamentous_cyano_meta.csv")
# Chunk 5
summary(filament_cyanos)
# Chunk 6
head(filament_cyanos)
# Chunk 7
filament_cyanos <- clean_names(filament_cyanos)
# Chunk 8
names(filament_cyanos)
# Chunk 9
head(filament_cyanos)
# Chunk 10
gene_data_genus <- filament_cyanos %>%
select(genus, contains("gene_")) %>%
pivot_longer(-genus,
names_to = "gene",
values_to = "gene_count") %>%
filter(!is.na(gene_count))
gene_data_genus
# Chunk 11
gene_data_genus$gene_count <- as.factor(gene_data_genus$gene_count)
# Chunk 12
fil_heatmap <- gene_data_genus %>%
ggplot(aes(y=gene, x=genus))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "right",
text = element_text(size=6),
axis.text.x = element_text(angle = 45, hjust=1))+
coord_fixed()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Genera",x = "Genus", y = "Gene")
ggsave("figures/fil_gene_count_genus_heatmap.svg", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap
# Chunk 13
gene_data_organism <- filament_cyanos %>%
select(organism, contains("gene_")) %>% # get rid of the gene_ part for the final pres.
pivot_longer(-organism,
names_to = "gene",
values_to = "gene_count") %>%
filter(!is.na(gene_count))
gene_data_organism
# Chunk 14
gene_data_organism$gene_count <- as.numeric(gene_data_organism$gene_count) # needs to be numeric for scale()
lapply(gene_data_organism, class)
# Chunk 15
clust_map_org <- gene_data_organism %>% # make pivot_wider for scale()
pivot_wider(names_from = "gene",
values_from = "gene_count")
clust_map_org
# Chunk 16
#clust_map_org <- scale(clust_map_org)
#clust_map_org %>%
#mutate(across(where(is.numeric, scale))
# this is where I got the info
# https://jcoliver.github.io/learn-r/008-ggplot-dendrograms-and-heatmaps.html
scaled_clust_map <- clust_map_org
scaled_clust_map[, c(2:22)] <- scale(scaled_clust_map[, 2:22])
scaled_clust_map
# Chunk 17
scaled_matrix <- as.matrix(scaled_clust_map[, c(2:22)])
rownames(scaled_matrix) <- scaled_clust_map$organism
organisms_dendro <- as.dendrogram(hclust(d = dist(x = scaled_matrix)))
# Chunk 18
dendro_plot <- ggdendrogram(data = organisms_dendro, rotate = TRUE)
dendro_plot
# Chunk 19
dendro_plot <- dendro_plot + theme(axis.text.y = element_text(size = 0))
dendro_plot
# Chunk 20
gene_data_organism$gene_count <- as.factor(gene_data_organism$gene_count)
lapply(gene_data_organism, class)
# Chunk 21
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "right",
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1))+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
ggsave("figures/fil_gene_count_heatmap.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap
# Chunk 22
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.7, y = 0.5, width = 0.2, height = 0.98))
# Chunk 23
temperature_gene <- filament_cyanos %>%
select(organism, tempurature_avg, contains("gene_")) %>%
filter(!is.na(tempurature_avg))
temperature_gene
# Chunk 24
temp_organism <- filament_cyanos %>%
select(organism, tempurature_avg, genus) %>%
filter(!is.na(tempurature_avg)) %>%
ggplot(aes(x = organism, y = tempurature_avg, fill = genus)) +
geom_col()+
scale_fill_viridis(discrete=TRUE, option = "mako")+
theme(legend.position = "right",
text = element_text(size=10),
axis.text.x = element_text(angle = 60, hjust=1))+
labs(title = "Environmental Temperature for Cyanobacteria Species",x = "Cyanobacteria", y = "Temperature C")
temp_organism
ggsave("figures/temp_organism_plot.png", width=10, height=6, plot = temp_organism, dpi = 200)
# Chunk 25
temp_organism <- filament_cyanos %>%
select(organism, tempurature_avg, genus, gene_des_a) %>%
filter(!is.na(tempurature_avg)) %>%
filter(!is.na(gene_des_a)) %>%
ggplot(aes(x = organism, y = gene_des_a, fill = genus)) +
geom_col()+
scale_fill_viridis(discrete=TRUE, option = "mako")+
theme(legend.position = "right",
text = element_text(size=10),
axis.text.x = element_text(angle = 60, hjust=1))+
labs(title = "CTG count for Cyanobacteria Species",x = "Cyanobacteria", y = "DesA Gene Count")
ggsave("figures/fil_gene_plot.png", width=10, height=6, plot = temp_organism, dpi = 200)
temp_organism
# Chunk 26
library("tidyverse")
library("janitor")
# Chunk 27
filament_cyanos <- read_csv("data/filamentous_cyano_meta.csv") %>% clean_names()
trim_fil_cyn <- filament_cyanos %>%
filter(!is.na(tempurature_avg)) %>%
select(genus, organism, starts_with("gene_")) %>%
mutate(organism = as.factor(organism), genus = as.factor(genus))
head(trim_fil_cyn)
# Chunk 28
trim_fil_cyn_long <- trim_fil_cyn %>%
pivot_longer(-c(genus, organism),
names_to ="gene",
values_to = "n")
trim_fil_cyn_long
# Chunk 29
trim_fil_cyn_long2<- trim_fil_cyn_long %>%
filter(n!=is.na(n))
trim_fil_cyn_long2
# Chunk 30
library(shiny)
library(shinydashboard)
library(shiny)
#ui <- dashboardPage(
dashboardHeader( title = "CTG count for Cyanobacteria Species"),
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.7, y = 0.5, width = 0.2, height = 0.98))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.7, y = 0.5, width = 0.2, height = 0.95))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.65, y = 0.5, width = 0.2, height = 0.95))
