fil_heatmap <- gene_data_genus %>%
ggplot(aes(y=gene, x=genus))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "right",
text = element_text(size=6),
axis.text.x = element_text(angle = 45, hjust=1))+
coord_fixed()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Genera",x = "Genus", y = "Gene")
ggsave("figures/fil_gene_count_genus_heatmap.svg", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap
gene_data_organism <- filament_cyanos %>%
select(organism, contains("gene_")) %>% # get rid of the gene_ part for the final pres.
pivot_longer(-organism,
names_to = "gene",
values_to = "gene_count") %>%
filter(!is.na(gene_count))
gene_data_organism
gene_data_organism$gene_count <- as.numeric(gene_data_organism$gene_count) # needs to be numeric for scale()
lapply(gene_data_organism, class)
clust_map_org <- gene_data_organism %>% # make pivot_wider for scale()
pivot_wider(names_from = "gene",
values_from = "gene_count")
clust_map_org
#clust_map_org <- scale(clust_map_org)
#clust_map_org %>%
#mutate(across(where(is.numeric, scale))
# this is where I got the info
# https://jcoliver.github.io/learn-r/008-ggplot-dendrograms-and-heatmaps.html
scaled_clust_map <- clust_map_org
scaled_clust_map[, c(2:22)] <- scale(scaled_clust_map[, 2:22])
scaled_clust_map
scaled_matrix <- as.matrix(scaled_clust_map[, c(2:22)])
rownames(scaled_matrix) <- scaled_clust_map$organism
organisms_dendro <- as.dendrogram(hclust(d = dist(x = scaled_matrix)))
dendro_plot <- ggdendrogram(data = organisms_dendro, rotate = TRUE)
dendro_plot
dendro_plot <- dendro_plot + theme(axis.text.y = element_text(size = 0))
dendro_plot
gene_data_organism$gene_count <- as.factor(gene_data_organism$gene_count)
lapply(gene_data_organism, class)
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "right",
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1))+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
ggsave("figures/fil_gene_count_heatmap.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.65, y = 0.5, width = 0.2, height = 0.95))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.7, y = 0.5, width = 0.2, height = 0.95))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.7, y = 0.5, width = 0.2, height = 0.98))
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "right",
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1),
ledgend.position = "bottom")+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
ggsave("figures/fil_gene_count_heatmap.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "right",
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1),
legend.position = "bottom")+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "right",
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1),
legend.position = "bottom")+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "bottom",
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1))+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
ggsave("figures/fil_gene_count_heatmap.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.7, y = 0.5, width = 0.2, height = 0.98))
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "bottom",
legend.direction = "horizontal"
text = element_text(size=6),
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "bottom",
legend.direction = "horizontal",
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1))+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
ggsave("figures/fil_gene_count_heatmap.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "bottom",
legend.direction = "vertical",
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1))+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
ggsave("figures/fil_gene_count_heatmap.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "bottom",
legend.key.height = 1,
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1))+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
ggsave("figures/fil_gene_count_heatmap.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "bottom",
legend.key.height = "1",
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1))+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
ggsave("figures/fil_gene_count_heatmap.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "bottom",
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1))+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
ggsave("figures/fil_gene_count_heatmap.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "bottom",
legend.key.size = 6
text = element_text(size=6),
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "bottom",
legend.key.size = 6,
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1))+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
ggsave("figures/fil_gene_count_heatmap.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "bottom",
legend.key.size = 0.5,
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1))+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
ggsave("figures/fil_gene_count_heatmap.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "bottom",
legend.key.size = unit(1, "cm"),
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1))+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
ggsave("figures/fil_gene_count_heatmap.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "bottom",
legend.key.size = unit(0.2, "cm"),
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1))+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
ggsave("figures/fil_gene_count_heatmap.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.7, y = 0.5, width = 0.2, height = 0.98))
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "bottom", "left",
legend.key.size = unit(0.2, "cm"),
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1))+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
ggsave("figures/fil_gene_count_heatmap.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "bottom",
legend.box = "horizontal",
legend.key.size = unit(0.2, "cm"),
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1))+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
ggsave("figures/fil_gene_count_heatmap.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "bottom",
legend.align = 0,
legend.key.size = unit(0.2, "cm"),
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1))+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
ggsave("figures/fil_gene_count_heatmap.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "bottom",
legend.title.align = 0,
legend.key.size = unit(0.2, "cm"),
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1))+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
ggsave("figures/fil_gene_count_heatmap.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap
fil_heatmap <- gene_data_organism %>%
ggplot(aes(y=gene, x=organism))+
geom_tile(aes(fill= gene_count))+
scale_fill_viridis(discrete=TRUE, direction = -1, option = "mako")+
theme(legend.position = "bottom",
legend.justification = "left",
legend.key.size = unit(0.2, "cm"),
text = element_text(size=6),
axis.text.x = element_text(angle = 60, hjust=1))+
coord_flip()+ #maintains aspect ratio so 1 unit on x is 1 unit on y
labs(title = "Cold Tolerance Gene Count for Cyanobacteria Strains",x = "Cyanobacteria", y = "Gene")
ggsave("figures/fil_gene_count_heatmap.png", width=10, height=6, plot = fil_heatmap, dpi = 200)
fil_heatmap
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.7, y = 0.5, width = 0.2, height = 0.98))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.9, y = 0.5, width = 0.2, height = 0.98))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.9, y = 0.5, width = 0.2, height = 0.75))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.9, y = 0.9, width = 0.2, height = 0.75))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.9, y = 0.75, width = 0.2, height = 0.75))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.9, y = 0.6, width = 0.2, height = 0.75))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.9, y = 0.6, width = 0.2, height = 0.8))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.9, y = 0.58, width = 0.2, height = 0.8))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.9, y = 0.58, width = 0.2, height = 0.85))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.9, y = 0.58, width = 0.2, height = 0.81))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.86, y = 0.58, width = 0.2, height = 0.81))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.82, y = 0.58, width = 0.2, height = 0.81))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.85, y = 0.58, width = 0.2, height = 0.81))
grid.newpage()
print(fil_heatmap,
vp = viewport(x = 0.4, y = 0.5, width = 0.8, height = 1.0))
print(dendro_plot,
vp = viewport(x = 0.9, y = 0.58, width = 0.2, height = 0.81))
dendro_plot <- dendro_plot +
theme(axis.text.y = element_text(size = 0),
legend.text = element_text(size = 0))
dendro_plot
knitr::opts_chunk$set(echo = TRUE)
scaled_clust_map2 <- clust_map_org
scaled_clust_map2 <- scale(df)
knitr::opts_chunk$set(echo = TRUE)
#install.packages("viridisLite")
#install.packages("svglite")
#install.packages("factoextra")
#install.packages("cluster")
#install.packages("ggdendro")
#install.packages("grid")
library(tidyverse)
library(RColorBrewer)
library(paletteer)
library(janitor)
library(here)
library(skimr)
library(viridis)
library(shiny)
library(shinydashboard)
library(devtools)
library(svglite)
#library(cluster)
#library(factoextra)
library(ggdendro)
library(grid)
filament_cyanos <- readr::read_csv("data/filamentous_cyano_meta.csv")
summary(filament_cyanos)
filament_cyanos <- clean_names(filament_cyanos)
names(filament_cyanos)
head(filament_cyanos)
gene_data_organism <- filament_cyanos %>%
select(organism, contains("gene_")) %>% # get rid of the gene_ part for the final pres.
pivot_longer(-organism,
names_to = "gene",
values_to = "gene_count") %>%
filter(!is.na(gene_count))
gene_data_organism
gene_data_organism$gene_count <- as.numeric(gene_data_organism$gene_count) # needs to be numeric for scale()
lapply(gene_data_organism, class)
clust_map_org <- gene_data_organism %>% # make pivot_wider for scale()
pivot_wider(names_from = "gene",
values_from = "gene_count")
clust_map_org
scaled_clust_map2 <- clust_map_org
scaled_clust_map2 <- scale(df)
scaled_clust_map2 <- clust_map_org
scaled_clust_map2 <- scale(scaled_clust_map2)
scaled_clust_map <- clust_map_org
scaled_clust_map[, c(2:22)] <- scale(scaled_clust_map[, 2:22])
scaled_clust_map
m <- c("gene_gyr_a", "gene_nus_a", "gene_inf_c", "gene_inf_a", "gene_ots_a", "gene_dna_k", "gene_rec_a", "gene_dna_j", "gene_ace_f", "gene_dea_d", "gene_inf_b", "gene_tig", "gene_rnr", "gene_dna_a", "gene_hup_b", "gene_rbf_a", "gene_yfl_a", "gene_pnp", "gene_csp", "gene_ace_e", "gene_des_a")
names(m) <- c( "average", "single", "complete", "ward")
ac <- function(x) {
agnes(df, method = x)$ac
}
sapply(m, ac)
library(tidyverse)
library(RColorBrewer)
library(paletteer)
library(janitor)
library(here)
library(skimr)
library(viridis)
library(shiny)
library(shinydashboard)
library(devtools)
library(svglite)
library(cluster)
library(factoextra)
library(ggdendro)
library(grid)
ac <- function(x) {
agnes(df, method = x)$ac
}
sapply(m, ac)
knitr::opts_chunk$set(echo = TRUE)
#install.packages("viridisLite")
#install.packages("svglite")
#install.packages("factoextra")
#install.packages("cluster")
#install.packages("ggdendro")
#install.packages("grid")
library(tidyverse)
library(RColorBrewer)
library(paletteer)
library(janitor)
library(here)
library(skimr)
library(viridis)
library(shiny)
library(shinydashboard)
library(devtools)
library(svglite)
library(cluster)
library(factoextra)
library(ggdendro)
library(grid)
filament_cyanos <- readr::read_csv("data/filamentous_cyano_meta.csv")
summary(filament_cyanos)
filament_cyanos <- clean_names(filament_cyanos)
names(filament_cyanos)
head(filament_cyanos)
gene_data_organism <- filament_cyanos %>%
select(organism, contains("gene_")) %>% # get rid of the gene_ part for the final pres.
pivot_longer(-organism,
names_to = "gene",
values_to = "gene_count") %>%
filter(!is.na(gene_count))
gene_data_organism
gene_data_organism$gene_count <- as.numeric(gene_data_organism$gene_count) # needs to be numeric for scale()
lapply(gene_data_organism, class)
clust_map_org <- gene_data_organism %>% # make pivot_wider for scale()
pivot_wider(names_from = "gene",
values_from = "gene_count")
clust_map_org
scaled_clust_map <- clust_map_org
scaled_clust_map[, c(2:22)] <- scale(scaled_clust_map[, 2:22])
scaled_clust_map
m <- c("gene_gyr_a", "gene_nus_a", "gene_inf_c", "gene_inf_a", "gene_ots_a", "gene_dna_k", "gene_rec_a", "gene_dna_j", "gene_ace_f", "gene_dea_d", "gene_inf_b", "gene_tig", "gene_rnr", "gene_dna_a", "gene_hup_b", "gene_rbf_a", "gene_yfl_a", "gene_pnp", "gene_csp", "gene_ace_e", "gene_des_a")
names(m) <- c( "average", "single", "complete", "ward")
ac <- function(x) {
agnes(df, method = x)$ac
}
sapply(m, ac)
m <- c("average", "single", "complete", "ward")
names(m) <- c( "average", "single", "complete", "ward")
ac <- function(x) {
agnes(df, method = x)$ac
}
sapply(m, ac)
ac <- function(x) {
agnes(scaled_clust_map, method = x)$ac
}
sapply(m, ac)
clust <- agnes(df, method = "ward")
clust <- agnes(scaled_clust_map, method = "ward")
pltree(clust, cex = 0.6, hang = -1, main = "Dendrogram")
gap_stat <- clusGap(df, FUN = hcut, nstart = 25, K.max = 10, B = 50)
gap_stat <- clusGap(scaled_clust_map, FUN = hcut, nstart = 25, K.max = 10, B = 50)
gap_stat <- clusGap(scaled_clust_map, FUN = hcut, nstart = 25, K.max = 10, B = 50)
